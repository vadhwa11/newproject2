<?xml version="1.0" encoding="UTF-8"  ?>
<!-- Created with iReport - A designer for JasperReports -->
<!DOCTYPE jasperReport PUBLIC "//JasperReports//DTD Report Design//EN" "http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">
<jasperReport
		 name="sub_LPO_Register_Report"
		 columnCount="1"
		 printOrder="Vertical"
		 orientation="Landscape"
		 pageWidth="1080"
		 pageHeight="864"
		 columnWidth="1080"
		 columnSpacing="0"
		 leftMargin="0"
		 rightMargin="0"
		 topMargin="0"
		 bottomMargin="0"
		 whenNoDataType="NoPages"
		 isTitleNewPage="false"
		 isSummaryNewPage="false">
	<property name="ireport.scriptlethandling" value="0" />
	<property name="ireport.encoding" value="UTF-8" />
	<import value="java.util.*" />
	<import value="net.sf.jasperreports.engine.*" />
	<import value="net.sf.jasperreports.engine.data.*" />

	<parameter name="fromDate" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="toDate" isForPrompting="false" class="java.util.Date">
		<defaultValueExpression ><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="supplierId" isForPrompting="false" class="java.lang.Integer">
		<defaultValueExpression ><![CDATA[new Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="deptId" isForPrompting="false" class="java.lang.Integer">
		<defaultValueExpression ><![CDATA[new Integer(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="po_number" isForPrompting="true" class="java.lang.String">
		<defaultValueExpression ><![CDATA[new String("")]]></defaultValueExpression>
	</parameter>
	<parameter name="query" isForPrompting="true" class="java.lang.String">
		<defaultValueExpression ><![CDATA[new String("")]]></defaultValueExpression>
	</parameter>
	<queryString><![CDATA[select a.po_number, a.po_date, d.pvms_no, d.nomenclature, f.unit_name, b.quantity_ordered,
ifnull(b.quantity_received,0) quantity_received,  (b.quantity_ordered - ifnull(b.quantity_received,0)) quantity_pending,
ifnull(b.free_quantity,0) free_quantity , ifnull(b.rate_per_mdq,0) unit_rate, ifnull(b.discount_percent,0) discount_percent,
ifnull(b.tax_percent,0)tax_percent, b.amount,
concat(c.supplier_name,' [',c.supplier_code,']') supplier_name,
concat('Distributor: ',c.cf_local_distributor_name) cf_local_distributor_name,
c.cf_local_distributor_address1, c.cf_local_distributor_address2,
concat(round(case e.`formula`
     when 1
     then truncate(((b.`quantity_ordered` * e.`conversion_factor1`) / b.`mdq_value`),0)
     else b.`quantity_ordered` * e.`conversion_factor1`  end,0),' ',f.`unit_name`,'(',b.`mdq_value`,')') as Qty,
case when isnull(tender_id) then a.fileno else g.tender_no end as fileno,
case when isnull(h.invoice_no) then "" else h.invoice_no end as invoice_no , h.grn_no,h.grn_date ,
case when b.cancelled ='y' then '[Cancelled]'
     when b.closed ='y' then '[Closed]'
     else ''
end as cancelled_closed  
from store_po_header a
LEFT OUTER JOIN store_po_detail b on a.po_id = b.po_id
LEFT OUTER JOIN mas_store_supplier c on a.supplier_id = c.supplier_id
LEFT OUTER JOIN mas_store_item d on b.item_id = d.item_id
LEFT OUTER JOIN mas_store_item_conversion e on d.item_conversion_id = e.item_conversion_id
LEFT OUTER JOIN mas_store_unit f on e.purchase_unit_id = f.unit_id
LEFT OUTER JOIN store_grn_m h on a.po_id = h.po_id
LEFT OUTER JOIN store_tender_m g on a.tender_id = g.id
where a.department_id = $P{deptId} and a.po_number = $P{po_number}
and a.po_date >=  $P{fromDate} and a.po_date <= $P{toDate} 
$P!{query}
order by a.po_date, a.po_number, d.pvms_no]]></queryString>

	<field name="po_number" class="java.lang.String"/>
	<field name="po_date" class="java.sql.Date"/>
	<field name="pvms_no" class="java.lang.String"/>
	<field name="nomenclature" class="java.lang.String"/>
	<field name="unit_name" class="java.lang.String"/>
	<field name="quantity_ordered" class="java.math.BigDecimal"/>
	<field name="quantity_received" class="java.math.BigDecimal"/>
	<field name="quantity_pending" class="java.math.BigDecimal"/>
	<field name="free_quantity" class="java.math.BigDecimal"/>
	<field name="unit_rate" class="java.math.BigDecimal"/>
	<field name="discount_percent" class="java.math.BigDecimal"/>
	<field name="tax_percent" class="java.math.BigDecimal"/>
	<field name="amount" class="java.math.BigDecimal"/>
	<field name="supplier_name" class="java.lang.String"/>
	<field name="cf_local_distributor_name" class="java.lang.String"/>
	<field name="cf_local_distributor_address1" class="java.lang.String"/>
	<field name="cf_local_distributor_address2" class="java.lang.String"/>
	<field name="Qty" class="java.lang.String"/>
	<field name="fileno" class="java.lang.String"/>
	<field name="invoice_no" class="java.lang.String"/>
	<field name="grn_no" class="java.lang.String"/>
	<field name="grn_date" class="java.sql.Date"/>
	<field name="cancelled_closed" class="java.lang.String"/>

		<background>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</background>
		<title>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</title>
		<pageHeader>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</pageHeader>
		<columnHeader>
			<band height="1"  isSplitAllowed="true" >
			</band>
		</columnHeader>
		<detail>
			<band height="21"  isSplitAllowed="true" >
				<textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="70"
						y="0"
						width="207"
						height="20"
						key="textField-1"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font fontName="Arial"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{nomenclature}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="338"
						y="0"
						width="73"
						height="20"
						key="textField-2"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Left">
						<font fontName="Arial"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{Qty}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="##0.00" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="417"
						y="0"
						width="58"
						height="20"
						key="textField-3"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Left">
						<font fontName="Arial"/>
					</textElement>
				<textFieldExpression   class="java.math.BigDecimal"><![CDATA[$F{unit_rate}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="##0.00" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="478"
						y="0"
						width="68"
						height="20"
						key="textField-4"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Right">
						<font fontName="Arial"/>
					</textElement>
				<textFieldExpression   class="java.math.BigDecimal"><![CDATA[$F{amount}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="##0.00" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="548"
						y="0"
						width="36"
						height="20"
						key="textField-5"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Center">
						<font fontName="Arial"/>
					</textElement>
				<textFieldExpression   class="java.math.BigDecimal"><![CDATA[$F{tax_percent}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="277"
						y="0"
						width="60"
						height="19"
						key="textField-6"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font fontName="Arial"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{unit_name}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="592"
						y="0"
						width="126"
						height="20"
						key="textField-7"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Left">
						<font fontName="Arial"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{fileno}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="721"
						y="0"
						width="78"
						height="20"
						key="textField-8"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{invoice_no}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="797"
						y="0"
						width="88"
						height="20"
						key="textField-9"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{grn_no}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="3"
						y="0"
						width="64"
						height="20"
						key="textField-10"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font fontName="Arial"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{pvms_no}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" pattern="dd/MM/yyyy" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="883"
						y="0"
						width="91"
						height="18"
						key="textField"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font/>
					</textElement>
				<textFieldExpression   class="java.util.Date"><![CDATA[$F{grn_date}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="963"
						y="0"
						width="56"
						height="18"
						key="textField"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{cancelled_closed}]]></textFieldExpression>
				</textField>
			</band>
		</detail>
		<columnFooter>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</columnFooter>
		<pageFooter>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</pageFooter>
		<summary>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</summary>
</jasperReport>
